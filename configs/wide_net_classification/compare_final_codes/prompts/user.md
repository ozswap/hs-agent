Product: "{product_description}"

Number of paths to compare: {path_count}

Here are the classification paths that were explored:

{classification_paths}

---

CHAPTER NOTES (CRITICAL - these contain precedence rules and exclusions):

{chapter_notes}

---

Task: Compare all these classification paths and select THE SINGLE BEST HS code for this product.

Important considerations:

FIRST - Check for mandatory instructions in chapter notes:

Chapter notes may contain mandatory instructions that eliminate certain paths before you even begin quality comparison. Look for specific language:
- "shall" or "must" indicate mandatory requirements
- "are to be" indicates a binding directive you must follow
- "do not cover" or "excluding" indicate absolute exclusions
- "only when" or "provided that" indicate conditional requirements that must be met

If any path violates a mandatory instruction in the chapter notes, that path is invalid. Mark it as invalid and explain why, citing the specific note language that creates the requirement.

After identifying which paths comply with mandatory instructions, evaluate the remaining valid paths:

Consider the complete reasoning chain from chapter to subheading. Don't just pick the highest confidence score - look at the quality of reasoning at each level. Identify which path has the most compelling and defensible justification. Look for red flags or weak justifications in the reasoning. Consider which classification customs authorities would most likely accept.

Compare the paths based on:
- How precisely each HS code matches the product
- How well-justified each classification path is
- Which path has the strongest reasoning at each level
- Which classification is most defensible for customs
- Which code is most specific and practical for trade

Remember: When chapter notes say something "must" or "shall" be done, or products "are to be" classified a certain way, this is not optional. Follow the mandatory instruction even if your inference or intuition suggests otherwise. The notes are binding legal requirements.

You must provide:
- selected_code: The single best 6-digit HS code (from the explored paths), or "000000" if the description is invalid/meaningless
- confidence: Your confidence in this selection (0.0 to 1.0)
- reasoning: Detailed explanation of why this code is better than the alternatives, including what makes this path superior and what the weaknesses are in the other paths (or why the description is invalid)
- comparison_summary: Brief summary of how you compared the paths and what factors were decisive

Note: If the product description is completely invalid, meaningless, or just a test input (e.g., "test", gibberish), you may select "000000" instead of forcing a classification from the explored paths.

This is the final classification decision. Be thorough, precise, and decisive.
